
//1st program-gpio
#include <iostream>
#include <stdint.h>
#include <stm32f405xx.h>

#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif

void led_config()
{
	RCC->AHB1ENR |= (1<<1)|(1<<2); //enable clock to GPIOB/GPIOC

	GPIOC->MODER |= (1<<12); //PC6 as output
	GPIOC->OTYPER &=  ~(1<<6); //PC6 as push pull type
	GPIOC->OSPEEDR |=(1<<12); //PC6 at medium speed

    GPIOB->MODER |= (1<<26); //PB13 as output
	GPIOB->OTYPER &= ~(1<<13); //PB13 as push pull type
	GPIOB->OSPEEDR |=(1<<26); //PB13 at medium speed

	GPIOB->MODER |= (1<<28); //PB14 as output
	GPIOB->OTYPER &=  ~(1<<14); //PB14 as push pull type
	GPIOB->OSPEEDR |=(1<<28);//PB14 at medium speed

}
void switch_config()
{
	GPIOB->MODER &= ~(3<<14); //PB7 as switch input
	GPIOB->MODER &= ~(3<<6); //PB3 as switch input
	GPIOB->MODER &= ~(3<<8);//PB4 as switch input
}

int main(void)
{
	led_config();
	switch_config();

	for(;;)
		{
		  if(GPIOB->IDR & (1<<7))
		  {
			GPIOC->ODR |= (1<<6);
		  }
			else
		  {
				GPIOC->ODR  &= ~(1<<6);
		  }
		 if(GPIOB->IDR & (1<<3))
		 {
			GPIOB->ODR |= (1<<13);
		 }
		 else
		 {
			GPIOB->ODR  &= ~(1<<13);
		 }
		 if(GPIOB->IDR & (1<<4))
		{
		   GPIOB->ODR |= (1<<14);
		}
		else
		{
		   GPIOB->ODR  &= ~(1<<14);
		}
		}

}
